###############################################################################
# 示例环境变量文件 (.env.example)
# 请根据实际环境填写并重命名为 .env.development / .env.production / .env.test
###############################################################################

# 应用基础配置
NODE_ENV=development
PORT=3000
HOST=localhost
APP_NAME=Enterprise NestJS Backend
APP_VERSION=1.0.0
API_PREFIX=api/v1
TZ=Asia/Shanghai
APP_TIMEZONE=Asia/Shanghai

# CORS 配置
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001,http://127.0.0.1:3000

# 请求体大小限制配置
# 注意：这些限制只针对 JSON、表单等非文件上传的请求
# 文件上传的限制在下方 "文件上传配置" 部分
BODY_LIMIT_JSON=10mb                           # JSON 请求体大小限制
BODY_LIMIT_URLENCODED=10mb                     # URL 编码表单大小限制
BODY_LIMIT_RAW=10mb                            # 原始数据大小限制
BODY_LIMIT_TEXT=1mb                            # 文本数据大小限制

# 数据库配置
DATABASE_URL=mysql://root:password@localhost:3306/enterprise_db
DB_HOST=localhost
DB_PORT=3306
DB_USERNAME=root
DB_PASSWORD=password
DB_DATABASE=enterprise_db
DB_LOGGING=true
DB_SYNCHRONIZE=false

# 缓存配置
# CACHE_TYPE: 缓存类型选择
#   - 'redis': 使用 Redis 缓存（推荐用于生产环境）
#   - 'memory': 使用内存缓存（仅用于开发/测试环境，分布式部署下数据不一致）
#   - 'auto': 自动选择，优先 Redis，失败时降级为内存缓存（推荐用于开发环境）
CACHE_TYPE=auto

# Redis 配置
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_KEY_PREFIX=enterprise:example:

# JWT 配置
JWT_ACCESS_SECRET=your-super-secret-jwt-access-key-change-this-in-production
JWT_REFRESH_SECRET=your-super-secret-jwt-refresh-key-change-this-in-production
JWT_ACCESS_EXPIRES_IN=15m
JWT_REFRESH_EXPIRES_IN=7d
JWT_ISSUER=enterprise-nestjs-backend
JWT_AUDIENCE=enterprise-nestjs-backend

# 日志配置
LOG_LEVEL=info                    # 日志级别：debug, info, warn, error
LOG_DIR=logs                      # 日志文件存储目录
LOG_MAX_SIZE=20m                  # 单个日志文件最大大小
LOG_MAX_FILES=14d                 # 日志文件保留时间
LOG_DATE_PATTERN=YYYY-MM-DD       # 日志文件日期格式
LOG_ZIPPED_ARCHIVE=true           # 是否压缩归档旧日志
LOG_ENABLE_CONSOLE=true           # 输出到控制台（Docker 环境需要）

# 数据库日志配置
LOG_ENABLE_DATABASE=false         # 是否全局启用数据库日志
LOG_DB_RETENTION_DAYS=30          # 数据库日志保留天数

# 限流配置
# 三层限流策略：短时（秒级）、中时（分钟级）、长时（小时级）
# TTL 单位为毫秒
THROTTLE_SHORT_TTL=1000           # 短时限流时间窗口：1秒
THROTTLE_SHORT_LIMIT=20           # 短时限流次数：20次/秒
THROTTLE_MEDIUM_TTL=60000         # 中时限流时间窗口：1分钟
THROTTLE_MEDIUM_LIMIT=200         # 中时限流次数：200次/分钟
THROTTLE_LONG_TTL=3600000         # 长时限流时间窗口：1小时
THROTTLE_LONG_LIMIT=2000          # 长时限流次数：2000次/小时

# 文件上传配置
# ============================================================================
# 基础配置
UPLOAD_DEST=./uploads                              # 上传文件存储目录
UPLOAD_TEMP_DIR=./uploads/temp                     # 临时文件目录
UPLOAD_PRESERVE_ORIGINAL_NAME=false                # 是否保留原始文件名

# 通用上传限制
UPLOAD_MAX_FILE_SIZE=10485760                      # 单个文件最大: 10MB
UPLOAD_MAX_FILES=10                                # 单次请求最多文件数
UPLOAD_MAX_TOTAL_SIZE=52428800                     # 单次请求总大小: 50MB
UPLOAD_ALLOWED_MIMETYPES=image/jpeg,image/jpg,image/png,image/webp,image/gif,application/pdf

# 图片上传配置
UPLOAD_IMAGE_MAX_SIZE=5242880                      # 图片最大: 5MB
UPLOAD_IMAGE_ALLOWED_TYPES=image/jpeg,image/jpg,image/png,image/webp,image/gif
UPLOAD_IMAGE_SUB_DIR=images                        # 图片子目录
UPLOAD_IMAGE_ENABLE_COMPRESSION=false              # 是否启用压缩
UPLOAD_IMAGE_COMPRESSION_QUALITY=80                # 压缩质量 0-100
UPLOAD_IMAGE_MAX_WIDTH=2048                        # 最大宽度（像素）
UPLOAD_IMAGE_MAX_HEIGHT=2048                       # 最大高度（像素）

# 文档上传配置
UPLOAD_DOCUMENT_MAX_SIZE=10485760                  # 文档最大: 10MB
UPLOAD_DOCUMENT_ALLOWED_TYPES=application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document
UPLOAD_DOCUMENT_SUB_DIR=documents                  # 文档子目录

# 视频上传配置
UPLOAD_VIDEO_MAX_SIZE=104857600                    # 视频最大: 100MB
UPLOAD_VIDEO_ALLOWED_TYPES=video/mp4,video/mpeg,video/quicktime
UPLOAD_VIDEO_SUB_DIR=videos                        # 视频子目录

# 音频上传配置
UPLOAD_AUDIO_MAX_SIZE=20971520                     # 音频最大: 20MB
UPLOAD_AUDIO_ALLOWED_TYPES=audio/mpeg,audio/wav,audio/mp3,audio/ogg
UPLOAD_AUDIO_SUB_DIR=audios                        # 音频子目录

# 头像上传配置
UPLOAD_AVATAR_MAX_SIZE=2097152                     # 头像最大: 2MB
UPLOAD_AVATAR_ALLOWED_TYPES=image/jpeg,image/jpg,image/png,image/webp
UPLOAD_AVATAR_SUB_DIR=avatars                      # 头像子目录
UPLOAD_AVATAR_ENABLE_COMPRESSION=true              # 启用头像压缩
UPLOAD_AVATAR_COMPRESSION_QUALITY=85               # 头像压缩质量
UPLOAD_AVATAR_WIDTH=200                            # 头像宽度（像素）
UPLOAD_AVATAR_HEIGHT=200                           # 头像高度（像素）

# 安全配置
UPLOAD_ENABLE_VIRUS_SCAN=false                     # 是否启用病毒扫描
UPLOAD_VERIFY_FILE_TYPE=true                       # 验证文件真实类型
UPLOAD_DENIED_EXTENSIONS=.exe,.bat,.cmd,.com,.pif,.scr,.vbs,.js,.jar,.sh

# 存储配置
UPLOAD_STORAGE_TYPE=local                          # 存储类型: local | s3 | oss | cos
UPLOAD_LOCAL_PATH=./uploads                        # 本地存储路径
UPLOAD_LOCAL_URL_PREFIX=http://localhost:3000/uploads  # 文件访问URL前缀

# S3/OSS/COS 云存储配置（可选，按需配置）
UPLOAD_S3_ENDPOINT=
UPLOAD_S3_BUCKET=
UPLOAD_S3_REGION=
UPLOAD_S3_ACCESS_KEY_ID=
UPLOAD_S3_SECRET_ACCESS_KEY=

# 安全配置
BCRYPT_ROUNDS=12
SESSION_SECRET=example-session-secret-key
CSRF_SECRET=example-csrf-secret-key
MAX_CONCURRENT_SESSIONS=5         # 最大并发登录设备数 (1-10, 设置为1实现单设备登录)

# CSRF 相关（double-submit / csurf cookie 模式用）
# CSRF_ENABLED: true|false — 是否启用 CSRF 中间件（生产环境按需开启）
CSRF_ENABLED=false
# CSRF_COOKIE_NAME: 前端可以读取的 CSRF cookie 名称
CSRF_COOKIE_NAME=XSRF-TOKEN
# CSRF_HEADER_NAME: 前端在非幂等请求中需携带的 header 名称
CSRF_HEADER_NAME=X-XSRF-TOKEN
# CSRF_COOKIE_SAMESITE: lax|strict|none
CSRF_COOKIE_SAMESITE=lax
# CSRF_COOKIE_MAXAGE: cookie 最大生存时间（秒），0 为会话级
CSRF_COOKIE_MAXAGE=0
# CSRF_EXEMPT_PATHS: 用逗号分隔的白名单路径，例: /health,/api/public,/hooks/receiver
CSRF_EXEMPT_PATHS=

# 邮件配置 (可选)
MAIL_HOST=
MAIL_PORT=587
MAIL_USER=
MAIL_PASS=
MAIL_FROM=noreply@enterprise.local

# 外部服务配置 (可选)
SMS_API_KEY=
SMS_API_SECRET=
